{% extends "headteacher/base_headteacher.html" %}
{% block title %}{{ student.get_full_name|default:student.username }} – Kayıtlı Dersler{% endblock %}

{% block content %}
<h2 class="mb-4">
  {{ student.get_full_name|default:student.username }} – Kayıtlı Dersler
</h2>

{# --- Kayıtlı dersler + Dersten Çıkar --- #}
<div class="card shadow-sm mb-4">
  <div class="card-body">
    <h5 class="mb-3">Kayıtlı Olduğu Dersler</h5>

    {% if current_courses %}
      <table class="table align-middle mb-0">
        <thead>
          <tr>
            <th style="width: 50%;">Ders Adı</th>
            <th style="width: 20%;">Kod</th>
            <th style="width: 30%;" class="text-end">İşlem</th>
          </tr>
        </thead>
        <tbody>
          {% for course in current_courses %}
            <tr>
              <td>{{ course.course_name }}</td>
              <td>{{ course.course_code }}</td>
              <td class="text-end">
                <form method="post" class="d-inline">
                  {% csrf_token %}
                  <input type="hidden" name="action" value="remove">
                  <input type="hidden" name="course_id" value="{{ course.id }}">
                  <button type="submit" class="btn btn-sm btn-outline-danger">
                    Dersten Çıkar
                  </button>
                </form>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="text-muted mb-0">
        Bu öğrenci henüz hiçbir derse kayıtlı değil.
      </p>
    {% endif %}
  </div>
</div>

{# --- Yeni ders kaydı ekle --- #}
<div class="card shadow-sm">
  <div class="card-body">
    <h5 class="mb-3">Yeni Ders Kaydı Ekle</h5>

    {% if available_courses %}
      <form method="post" class="row g-3 align-items-center">
        {% csrf_token %}
        <input type="hidden" name="action" value="add">

        <div class="col-md-8">
          <select name="course_id" class="form-select">
            {% for course in available_courses %}
              <option value="{{ course.id }}">
                {{ course.course_code }} – {{ course.course_name }}
              </option>
            {% endfor %}
          </select>
        </div>

        <div class="col-md-4 text-end">
          <a href="{% url 'department_head_students' %}" class="btn btn-secondary me-2">
            Geri Dön
          </a>
          <button type="submit" class="btn btn-primary">
            Ekle
          </button>
        </div>
      </form>
    {% else %}
      <p class="text-muted mb-0">
        Kayıt edilebileceği başka ders kalmadı.
      </p>
      <div class="mt-3">
        <a href="{% url 'department_head_students' %}" class="btn btn-secondary">
          Geri Dön
        </a>
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}
