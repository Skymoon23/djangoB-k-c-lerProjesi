<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>{{ course.course_code }} Detay</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container-fluid mt-4">
  <div class="row">

    <!-- ===== SIDEBAR ===== -->
    <div class="col-md-3 col-lg-2">
      <div class="list-group">

        <div class="list-group-item fw-bold">
          {{ course.course_code }}
        </div>

        <a class="list-group-item list-group-item-action {% if section == 'grades' %}active{% endif %}"
           href="{% url 'student_course_detail' course.id %}?section=grades">
          Deƒüerlendirme & Notlar
        </a>

        <a class="list-group-item list-group-item-action {% if section == 'lo' %}active{% endif %}"
           href="{% url 'student_course_detail' course.id %}?section=lo">
          Learning Outcome
        </a>

        <a class="list-group-item list-group-item-action {% if section == 'po' %}active{% endif %}"
           href="{% url 'student_course_detail' course.id %}?section=po">
          Program Outcome
        </a>

        <a class="list-group-item list-group-item-action"
           href="{% url 'student_dashboard' %}">
          ‚Üê Derslerime D√∂n
        </a>

      <div class="list-group-item text-center">
            {% if course.syllabus %}
                <a href="{{ course.syllabus.url }}" target="_blank" class="btn btn-primary btn-sm w-100">
                    üìÑ Syllabus ƒ∞ndir
                </a>
            {% else %}
                <button class="btn btn-secondary btn-sm w-100" disabled>
                    Syllabus Y√ºklenmedi
                </button>
            {% endif %}
        </div>

      </div>
    </div>

    <!-- ===== CONTENT ===== -->
    <div class="col-md-9 col-lg-10">

      <h2 class="mb-1">{{ course.course_code }} - {{ course.course_name }}</h2>

      <!-- ===== 1) GRADES ===== -->
      {% if section == "grades" %}
        <p>Derse ait deƒüerlendirme bile≈üenleri ve notlarƒ±nƒ±z:</p>

        <table class="table table-bordered mt-3">
          <thead>
            <tr>
              <th>Bile≈üen</th>
              <th>Y√ºzde</th>
              <th>Not</th>
            </tr>
          </thead>
          <tbody>
            {% for item in component_grade_list %}
            <tr>
              <td>{{ item.name }}</td>
              <td>%{{ item.percentage }}</td>
              <td>
                {% if item.score %}
                  {{ item.score }}
                {% else %}
                  (N/A)
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endif %}

      <!-- ===== 2) LEARNING OUTCOME ===== -->
      {% if section == "lo" %}
        <h3>Learning Outcome Skorlarƒ±nƒ±z</h3>

        {% if learning_outcome_scores %}
        <table class="table table-bordered mt-3">
          <thead>
            <tr>
              <th>Learning Outcome</th>
              <th>Skor</th>
            </tr>
          </thead>
          <tbody>
            {% for lo_data in learning_outcome_scores %}
            <tr>
              <td>
                <strong>LO #{{ lo_data.outcome.id }}:</strong><br>
                <small class="text-muted">{{ lo_data.outcome.description }}</small>
              </td>
              <td>
                {% if lo_data.score is not None %}
                  {{ lo_data.score|floatformat:2 }}
                {% else %}
                  <span class="text-muted">Hesaplanamadƒ±</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
          <p class="text-muted mt-3">Learning Outcome verisi bulunamadƒ±.</p>
        {% endif %}
      {% endif %}

      <!-- ===== 3) PROGRAM OUTCOME ===== -->
      {% if section == "po" %}
        <h3>Program Outcome Skorlarƒ±nƒ±z</h3>

        {% if program_outcome_scores %}
        <table class="table table-bordered mt-3">
          <thead>
            <tr>
              <th>Program Outcome</th>
              <th>Skor</th>
            </tr>
          </thead>
          <tbody>
            {% for po_data in program_outcome_scores %}
            <tr>
              <td>
                <strong>{{ po_data.program_outcome.code }}</strong><br>
                <small class="text-muted">{{ po_data.program_outcome.description }}</small>
              </td>
              <td>
                {% if po_data.score is not None %}
                  {{ po_data.score|floatformat:2 }}
                {% else %}
                  <span class="text-muted">Hesaplanamadƒ±</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
          <p class="text-muted mt-3">Program Outcome verisi bulunamadƒ±.</p>
        {% endif %}
      {% endif %}

    </div>
  </div>
</div>

</body>
</html>
